SELECT tblMETALS_AAS.timeDate, tblCHEMICALS.chemical, tblLINES.Line, tblMETALS_AAS.perAcid, IIf(IsNull([tblMETALS_AAS]![aluminum]),Null,IIf([tblMETALS_AAS]![unitAl]=2,[tblMETALS_AAS]![aluminum]/1000000,IIf(([tblMETALS_AAS]![unitAl]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![aluminum]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![aluminum]/100))) AS perAl, IIf(IsNull([tblMETALS_AAS]![Copper]),Null,IIf([tblMETALS_AAS]![unitCu]=2,[tblMETALS_AAS]![Copper]/1000000,IIf(([tblMETALS_AAS]![unitCu]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![Copper]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![Copper]/100))) AS perCu, IIf(IsNull([tblMETALS_AAS]![chromium]),Null,IIf([tblMETALS_AAS]![unitCr]=2,[tblMETALS_AAS]![chromium]/1000000,IIf(([tblMETALS_AAS]![unitCr]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![chromium]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![chromium]/100))) AS perCr, IIf(IsNull([tblMETALS_AAS]![Iron]),Null,IIf([tblMETALS_AAS]![unitFe]=2,[tblMETALS_AAS]![Iron]/1000000,IIf(([tblMETALS_AAS]![unitFe]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![Iron]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![Iron]/100))) AS perFe, IIf(IsNull([tblMETALS_AAS]![molybdenum]),Null,IIf([tblMETALS_AAS]![unitMo]=2,[tblMETALS_AAS]![molybdenum]/1000000,IIf(([tblMETALS_AAS]![unitMo]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![molybdenum]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![molybdenum]/100))) AS perMo, IIf(IsNull([tblMETALS_AAS]![Nickel]),Null,IIf([tblMETALS_AAS]![unitNi]=2,[tblMETALS_AAS]![Nickel]/1000000,IIf(([tblMETALS_AAS]![unitNi]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![Nickel]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![Nickel]/100))) AS perNi, IIf(IsNull([tblMETALS_AAS]![zinc]),Null,IIf([tblMETALS_AAS]![unitZn]=2,[tblMETALS_AAS]![zinc]/1000000,IIf(([tblMETALS_AAS]![unitZn]=1) And (IsNull([tblMETALS_AAS]![density])=False),[tblMETALS_AAS]![zinc]/(1000*[tblMETALS_AAS]![density]),[tblMETALS_AAS]![zinc]/100))) AS perZn, Nz([perAl],0)+Nz([perCr],0)+Nz([perCu],0)+Nz([perFe],0)+Nz([perMo],0)+Nz([perNi],0)+Nz([perZn],0) AS totPer, tblLABORATORIES.nameLab
FROM ((tblMETALS_AAS LEFT JOIN tblCHEMICALS ON tblMETALS_AAS.acid = tblCHEMICALS.ID) LEFT JOIN tblLINES ON tblMETALS_AAS.line = tblLINES.ID) LEFT JOIN tblLABORATORIES ON tblMETALS_AAS.laboratory = tblLABORATORIES.ID
WHERE (((tblMETALS_AAS.timeDate)>=[TempVars]![tmpDate1] And (tblMETALS_AAS.timeDate)<=[TempVars]![tmpDate2]) AND ((tblCHEMICALS.ID) Like [TempVars]![tmpCHEM]) AND ((tblLINES.ID) Like [TempVars]![tmpLINE]))
ORDER BY tblMETALS_AAS.timeDate, tblCHEMICALS.chemical, tblLINES.Line;
